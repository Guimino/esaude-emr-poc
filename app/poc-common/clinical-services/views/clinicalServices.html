<div class="content-border-margin">
  <div class="row">
    <p class="col-sm-4"><b>{{'COMMON_CLINICAL_SERVICE_HEADER_FORM'| translate}}</b></p>
    <p class="col-sm-4"><b>{{'COMMON_CLINICAL_SERVICE_HEADER_LAST'| translate}}</b></p>
    <p class="col-sm-2"><b>{{'COMMON_CLINICAL_SERVICE_HEADER_CREATOR'| translate}}</b></p>
    <p class="col-sm-2"><b>{{'COMMON_CLINICAL_SERVICE_HEADER_ACTIONS'| translate}}</b></p>
  </div>

  <div ng-if="vm.services.length === 0">
    <p class="text-center">{{'LOADING' | translate}}</p>
  </div>

  <div ng-repeat="service in vm.services">
    <div class="list-group-item" ng-if="service.showService">
      <div class="row">
        <div class="col-sm-4">
          <p>{{service.label | translate | uppercase}}</p>
        </div>
        <div class="col-sm-4">
          <p ng-if="service.lastEncounterForServiceMarked">
            {{service.lastEncounterForServiceDate | date:"MM/dd/yyyy hh:mm"}}
          </p>
          <p ng-if="!service.lastEncounterForServiceMarked">
            {{'COMMON_NONE'| translate}}
          </p>
        </div>
        <div class="col-sm-2">
          <p ng-if="service.lastEncounterForServiceMarked">
            {{service.lastEncounterForServiceMarked.provider.display}}
          </p>
          <p ng-if="!service.lastEncounterForServiceMarked">
            {{'COMMON_NONE'| translate}}
          </p>
        </div>
        <div class="col-sm-2 go-to-right">

          <poc-authorize privilege="vm.getPrivilege('Write', service)">
            <button ng-if="vm.canAdd(service)" class="btn btn-primary btn-lg" type="button"
                    ng-click="vm.linkServiceAdd(service)">
              <span class="glyphicon glyphicon-plus"></span>
              <span class="button-label">{{'ADD' | translate}}</span>
            </button>
          </poc-authorize>

          <poc-authorize privilege="vm.getPrivilege('Read', service)">
            <button ng-if="service.encountersForService.length > 0" class="btn btn-default btn-lg" type="button"
                    ng-click="vm.toggleListEncounters(service)">
              <span class="glyphicon glyphicon-list-alt"></span>
              <span class="button-label">{{'LIST' | translate}}</span>
            </button>
          </poc-authorize>

        </div>
      </div>
      <div class="row" ng-class="{'bg-warning': service.list}" ng-show="service.list">
        <div class="col-sm-12">
          <table class="table">
            <tbody>
            <tr ng-repeat="encounter in service.encountersForService">
              <td>
                <button class="btn btn-primary btn-lg" type="button" ng-click="vm.linkServiceDisplay(service, encounter)">
                  <span class="glyphicon glyphicon-eye-open"></span>
                  <span class="button-label">{{'COMMON_DATE'| translate}}: {{encounter.encounterDatetime| date:"MM/dd/yyyy hh:mm"}}</span>
                </button>
              </td>
              <td>
                <p>
                  <b>{{'COMMON_CLINICAL_SERVICE_HEADER_CREATOR'| translate}}:</b> {{encounter.provider.display}}
                </p>
              </td>
              <td class="go-to-right">
                <div ng-show="!encounter.delete">

                  <poc-authorize privilege="vm.getPrivilege('Edit', service)">
                    <button type="button" class="btn btn-default btn-lg" ng-click="vm.linkServiceEdit(service, encounter)">
                      <span class="glyphicon glyphicon-pencil"></span>
                      <span class="button-label">{{'EDIT' | translate}}</span>
                    </button>
                  </poc-authorize>

                  <poc-authorize privilege="vm.getPrivilege('Delete', service)">
                    <button type="button" class="btn btn-danger btn-lg" ng-click="vm.removeEncounter(encounter)">
                      <span class="glyphicon glyphicon-remove-sign"></span>
                      <span class="button-label">{{'REMOVE' | translate}}</span>
                    </button>
                  </poc-authorize>

                </div>
                <div ng-show="encounter.delete">
                  <button type="button" class="btn btn-danger btn-lg">
                    <span class="glyphicon glyphicon-ok-sign"></span>
                    <span class="button-label">{{'SAVE' | translate}}</span>
                  </button>
                  <button type="button" class="btn btn-warning btn-lg" ng-click="vm.removeEncounter(encounter)">
                    <span class="glyphicon glyphicon-minus-sign"></span>
                    <span class="button-label">{{'CANCEL' | translate}}</span>
                  </button>
                </div>
              </td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
